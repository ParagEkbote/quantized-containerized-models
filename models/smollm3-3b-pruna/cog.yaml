build:
  cog_runtime: true
  gpu: true
  cuda: "12.4"
  system_packages:
    - "libgl1-mesa-glx"
    - "libglib2.0-0"
    - "git"
    - "build-essential"
  python_version: "3.11"
  run:
    # Clear apt cache and update with retries
    - command: pip install uv
    - command: apt-get clean && rm -rf /var/lib/apt/lists/*
    - command: apt-get update --fix-missing || apt-get update --fix-missing || apt-get update
    # Install uv (precompiled binary, faster than pip)
    - command: curl -LsSf https://astral.sh/uv/install.sh | sh
    # Install Python packages with uv into system Python
    - command: uv pip install --system pruna==0.2.8
    - command: uv pip install --system colorama
    - command: uv pip install --system IPython
    # Export compiler path
    - command: export CC=/usr/bin/gcc

predict: "predict.py:Predictor"
